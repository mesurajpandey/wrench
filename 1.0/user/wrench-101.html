<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- For Mobile Devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta name="generator" content="Doxygen 1.8.6"/>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <title>WRENCH: WRENCH 101</title>
    <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
    <script type="text/javascript" src="jquery.smartmenus.js"></script>
    <!-- SmartMenus jQuery Bootstrap Addon -->
    <script type="text/javascript" src="jquery.smartmenus.bootstrap.js"></script>
    <!-- SmartMenus jQuery plugin -->
</head>
<body>
<nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <a href="http://wrench-project.org" class="navbar-brand">
                <img alt="Logo" src="logo-horizontal.png" width="160" style="float: left"/>
                1.0
            </a>
        </div>
        <div id="main-nav" class="nav navbar-nav navbar-right">
            <ul class="sm sm-dox nav navbar-nav navbar-right" id="main-menu">
                <li><a href="index.html">Overview</a></li>
                <li><a href="install.html">Installation</a></li>
                <li><a href="getting-started.html">Getting Started</a></li>
                <li><a href="wrench-101.html">WRENCH 101</a></li>
                <li><a href="annotated.html">API Reference</a></li>
                <li style="float: right">
                    <input type="hidden" id="MSearchField">
                </li>
            </ul>
        </div>
    </div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
    <div class="content" id="content">
        <div class="container">
            <div class="row">
                <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                    <div style="margin-bottom: 15px;">
                        <!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">WRENCH 101 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#wrench-101-simulator-10000ft">10,000-ft view of a WRENCH-based simulator</a></li>
<li class="level1"><a href="#wrench-101-simulator-blueprint">Blueprint for a WRENCH-based simulator</a></li>
<li class="level1"><a href="#wrench-101-simulator-services">Available services</a></li>
<li class="level1"><a href="#wrench-101-customizing-services">Customizing Services</a></li>
<li class="level1"><a href="#wrench-101-logging">Customizing logging</a></li>
<li class="level1"><a href="#wrench-101-simulation-output">Analyzing Simulation Output</a></li>
</ul>
</div>
<div class="textblock"><div class="doc-type">User Documentation</div><div class="doc-link">Other: <a href="../developer/wrench-101.html">Developer</a> - <a href="../internal/wrench-101.html">Internal</a></div><p>WRENCH 101 is a page and a set of documents that provide detailed information for each WRENCH's <a class="el" href="index.html#overview-users">classes of users</a>, and higher-level content than the <a href="./annotated.html">API Reference</a>. For instructions on how to <a class="el" href="install.html">install</a>, run a <a class="el" href="getting-started.html">first example</a>, or <a class="el" href="getting-started.html#getting-started-prep">create a basic WRENCH-based simulator</a>, please refer to their respective sections in the documentation.</p>
<p>This <b>User 101</b> guide describes all the WRENCH simulation components (building blocks) necessary to build a custom simulator and run simulation scenarios.</p>
<hr/>
<h1><a class="anchor" id="wrench-101-simulator-10000ft"></a>
10,000-ft view of a WRENCH-based simulator</h1>
<p>A WRENCH-based simulator can be as simple as a single <code>main()</code> function that first creates a platform to be simulated (the hardware) and a set of services that run on the platform (the software). These services correspond to software that knows how to store data, perform computation, and many other useful things that real-world cyberinfrastructure services can do.</p>
<p>The simulator then needs to create a workflow (or a set of workflows) to be executed, which consists of a set of compute tasks each with input and output files, and thus data-dependencies. A special service is then created, called a Workflow Management System (WMS), that will be in charge of executing the workflow on the platform. (This service must have been implemented by a WRENCH "developer", i.e., a user that has used the Developer API). The set of input files to the workflow, if any, are staged on the platform at particular storage locations.</p>
<p>The simulation is then launched via a single call. When this call returns, the WMS has terminated (typically after completing the execution of the workflow, or failing to executed it) and the simulation output can be analyzed.</p>
<h1><a class="anchor" id="wrench-101-simulator-blueprint"></a>
Blueprint for a WRENCH-based simulator</h1>
<p>Here are the steps that a WRENCH-based simulator typically follows:</p>
<ol type="1">
<li><b>Create and initialize a simulation</b> &ndash; In WRENCH, a user simulation is defined via the <code><a class="el" href="classwrench_1_1_simulation.html" title="A class that provides basic simulation methods. ">wrench::Simulation</a></code> class. An instance of this class must be created, and the <code><a class="el" href="classwrench_1_1_simulation.html#a3c6d35f1f77f35cbc727ce31e5689992" title="Initialize the simulation, which parses out WRENCH-specific and SimGrid-specific command-line argumen...">wrench::Simulation::init()</a></code> method is called to initialize the simulation (and parse WRENCH-specific and <a href="http://simgrid.gforge.inria.fr/simgrid/3.19/doc/options.html">SimGrid-specific</a> command-line arguments).</li>
<li><b>Instantiate a simulated platform</b> &ndash; This is done with the <code><a class="el" href="classwrench_1_1_simulation.html#ae22639abf6ede9f345b382f5ffe19b0e" title="Instantiate a simulated platform. ">wrench::Simulation::instantiatePlatform()</a></code> method which takes as argument a <a href="http://simgrid.gforge.inria.fr/simgrid/3.17/doc/platform.html">SimGrid virtual platform description file</a>. Any <a href="http://simgrid.gforge.inria.fr">SimGrid</a> simulation must be provided with the description of the platform on which an application/system execution is to be simulated (compute hosts, clusters of hosts, storage resources, network links, routers, routes between hosts, etc.)</li>
<li><b>Instantiate services on the platform</b> &ndash; The <code><a class="el" href="classwrench_1_1_simulation.html#ad1f5c12285ecfaf5a2ce7dab5ec8b4c5" title="Add a ComputeService to the simulation. The simulation takes ownership of the reference and will call...">wrench::Simulation::add()</a></code> method is used to add services to the simulation. Each class of service is created with a particular constructor, which also specifies host(s) on which the service is to be started. Typical kinds of services include compute services, storage services, network proximity services, and file registry services.</li>
<li><b>Create at least one workflow</b> &ndash; This is done by creating an instance of the <code><a class="el" href="classwrench_1_1_workflow.html" title="A workflow (to be executed by a WMS) ">wrench::Workflow</a></code> class, which has methods to manually add tasks and files to the workflow application, but also methods to import workflows from standard workflow description files (<a href="http://workflowarchive.org">DAX</a> and <a href="http://workflowhub.org/traces/">JSON</a>). If there are input files to the workflow's entry tasks, these must be staged on instantiated storage services.</li>
<li><b>Instantiate at least one WMS per workflow</b> &ndash; At least one of the services instantiated must be a <code><a class="el" href="classwrench_1_1_w_m_s.html" title="A workflow management system (WMS) ">wrench::WMS</a></code> instance, i.e., a service that is in charge of executing the workflow, as implemented by a WRENCH "developer" using the <a href="../developer/wrench-101.html">Developer</a> API. Associating a workflow to a WMS is done via the <code><a class="el" href="classwrench_1_1_w_m_s.html#afd2a6ae2f4d792046a6a17d5c0dc313f" title="Assign a workflow to the WMS. ">wrench::WMS::addWorkflow()</a></code> method.</li>
<li><b>Launch the simulation</b> &ndash; This is done via the <code><a class="el" href="classwrench_1_1_simulation.html#ae9589632de9a2311ed1d7f7747478985" title="Launch the simulation. ">wrench::Simulation::launch()</a></code> call which first sanity checks the simulation setup and then launches all simulated services, until all WMS services have exited (after they have completed or failed to complete workflows).</li>
<li><b>Process simulation output</b> &ndash; The <code><a class="el" href="classwrench_1_1_simulation.html#aff0338aa6831c6ac252cf0673fe68f44" title="Get the simulation output object. ">wrench::Simulation::getOutput()</a></code> method returns an object that is a collection of time-stamped traces of simulation events. These traces can be processed/analyzed at will.</li>
</ol>
<h1><a class="anchor" id="wrench-101-simulator-services"></a>
Available services</h1>
<p>To date, these are the (simulated) services that can be instantiated on the simulated platform:</p>
<ul>
<li><b>Compute Services</b> (classes that derive <code><a class="el" href="classwrench_1_1_compute_service.html" title="The compute service base class. ">wrench::ComputeService</a></code>): These are services that know how to compute workflow tasks. These include bare-metal servers (<code><a class="el" href="classwrench_1_1_multihost_multicore_compute_service.html" title="A compute service that manages a set of multi-core compute hosts and controls access to their resourc...">wrench::MultihostMulticoreComputeService</a></code>), cloud platforms (<code><a class="el" href="classwrench_1_1_cloud_service.html" title="A cloud-based compute service that manages a set of physical hosts and controls access to their resou...">wrench::CloudService</a></code>), virtualized cluster platforms (<code><a class="el" href="classwrench_1_1_virtualized_cluster_service.html" title="A virtualized cluster-based compute service. ">wrench::VirtualizedClusterService</a></code>), batch-scheduled clusters (<code><a class="el" href="classwrench_1_1_batch_service.html" title="A batch-scheduled compute service that manages a set of compute hosts and controls access to their re...">wrench::BatchService</a></code>). It is not technically required to instantiate a compute service, but then no workflow task can be executed by the WMS.</li>
<li><b>Storage Services</b> (classes that derive <code><a class="el" href="classwrench_1_1_storage_service.html" title="The storage service base class. ">wrench::StorageService</a></code>): These are services that know how to store workflow files, which can then be accessed in reading/writing by the compute services when executing tasks that read/write files. It is not technically required to instantiate a storage service, but then no workflow task can have an input or an output file.</li>
<li><b>File Registry Services</b> (the <code><a class="el" href="classwrench_1_1_file_registry_service.html" title="A file registry service (a.k.a. replica catalog) that holds a database of which files are available a...">wrench::FileRegistryService</a></code> class): These services, often known as <em>replica catalogs</em>, are simply databases of &lt;filename, list of locations&gt; key-value pairs of the storage services on which a copies of files are available. They are used during workflow execution to decide where input files for tasks can be acquired. It is not required to instantiate a file registry service, unless the workflow's entry tasks have input files (because in this case these files have to be stored at some storage services before the execution can start, and all file registry service are then automatically made aware of where these files are stored). Note that some WMS implementations may complain if no file registry service is available.</li>
<li><b>Network Proximity Services</b> (the class <code><a class="el" href="classwrench_1_1_network_proximity_service.html" title="A network proximity service that continuously estimates inter-host latencies and can be queried for s...">wrench::NetworkProximityService</a></code>): These are services that monitor the network and maintain a database of host-to-host network distances. This database can be queried by WMSs to make informed decisions, e.g., to pick from which storage service a file should be retrieved so as to reduce communication time. Typically, network distances are estimated based on round-trip-times between hosts. It is not required to instantiate a network proximity service, but some WMS implementations may complain if none is available.</li>
<li><b>Workflow Management Systems (WMSs)</b> (classes that derive <code><a class="el" href="classwrench_1_1_w_m_s.html" title="A workflow management system (WMS) ">wrench::WMS</a></code>): A workflow management system provides the mechanisms for executing workflow applications, include decision-making for optimizing various objectives (the most common one is to minimize workflow execution time). By default, WRENCH does not provide a WMS implementation as part of its core components, however a simple implementation (<code>wrench::SimpleWMS</code>) is available in the <code>examples/simple-example</code> folder. Please, refer to the <a href="../developer/wrench-101.html">Developer 101 Guide</a> section for further information on how to develop a WMS. At least <b>one</b> WMS should be provided for running a simulation. Additional WMSs implementations may also be found in the <a href="http://wrench-project.org">WRENCH project website</a>.</li>
</ul>
<h1><a class="anchor" id="wrench-101-customizing-services"></a>
Customizing Services</h1>
<p>Each service is customizable by passing to its constructor a <em>property list</em>, i.e., a key-value map where each key is a property and each value is a string. Each service defines a property class. For instance, the <code><a class="el" href="classwrench_1_1_service.html" title="A service that can be added to the simulation and that can be used by a WMS when executing a workflow...">wrench::Service</a></code> class has an associated <code><a class="el" href="classwrench_1_1_service_property.html" title="Configurable properties for a Service. ">wrench::ServiceProperty</a></code> class, the <code><a class="el" href="classwrench_1_1_compute_service.html" title="The compute service base class. ">wrench::ComputeService</a></code> class has an associated <code><a class="el" href="classwrench_1_1_compute_service_property.html" title="Configurable properties for a ComputeService. ">wrench::ComputeServiceProperty</a></code> class, and so on at all levels of the service class hierarchy.</p>
<p>The API documentation for these property classes explains what each property means, what possible values are, and what default values are. Other properties have more to do with what the service can or should do when in operation. For instance, the <code><a class="el" href="classwrench_1_1_batch_service_property.html" title="Configurable properties for a BatchService. ">wrench::BatchServiceProperty</a></code> class defines a <code><a class="el" href="classwrench_1_1_batch_service_property.html#aceb0af1c33f5ff2da347f54a484ce32e" title="The batch scheduling algorithm. Can be: ">wrench::BatchServiceProperty::BATCH_SCHEDULING_ALGORITHM</a></code> which specifies what scheduling algorithm a batch service should use for prioritizing jobs. All property classes inherit from the <code><a class="el" href="classwrench_1_1_service_property.html" title="Configurable properties for a Service. ">wrench::ServiceProperty</a></code> class, and one can explore that hierarchy to discover all possible (and there are many) service customization opportunities.</p>
<p>Finally, each service exchanges messages on the network with other services (e.g., a WMS service sends a "do some work" message to a compute service). The size in bytes, or payload, of all messages can be customized similarly to the properties, i.e., by passing a key-value map to the service's constructor. For instance, the <code><a class="el" href="classwrench_1_1_service_message_payload.html" title="Configurable message payloads for a Service. ">wrench::ServiceMessagePayload</a></code> class defines a <code><a class="el" href="classwrench_1_1_service_message_payload.html#a9efb4a6b2c8876e17a3f636ba5ac17f6" title="The number of bytes in the control message sent to the daemon to terminate it. ">wrench::ServiceMessagePayload::STOP_DAEMON_MESSAGE_PAYLOAD</a></code> property which can be used to customize the size, in bytes, of the control message sent to the service daemon (that is the entry point to the service) to tell it to terminate. Each service class has a corresponding message payload class, and the API documentation for these message payload classes details all messages whose payload can be customized.</p>
<h1><a class="anchor" id="wrench-101-logging"></a>
Customizing logging</h1>
<p>When running a WRENCH simulator you will notice that there is quite a bit of logging output. While logging output can be useful to inspect visually the way in which the simulation proceeds, it often becomes necessary to disable it. WRENCH's logging system is a thin layer on top of SimGrid's logging system, and as such is controlled via command-line arguments. The simple example in <code>examples/simple-example</code> is executed as follows, assuming the working directory is <code>examples/simple-example</code>:</p>
<p>``` ./wrench-simple-example-cloud platform_files/cloud_hosts.xml workflow_files/genome.dax ```</p>
<p>One first way in which to modify logging is to disable colors, which can be useful to redirect output to a file, is to use the <code>--wrench-no-color</code> command-line option, anywhere in the argument list, for instance:</p>
<p>``` ./wrench-simple-example-cloud &ndash;wrench-no-color platform_files/cloud_hosts.xml workflow_files/genome.dax ```</p>
<p>Disabling all logging is done with the SimGrid option <code>--log=root.threshold:critical</code>:</p>
<p>``` ./wrench-simple-example-cloud &ndash;log=root.threshold:critical platform_files/cloud_hosts.xml workflow_files/genome.dax ```</p>
<p>Particular "log categories" can be toggled on and off. Log category names are attached to <code>*.cpp</code> files in the WRENCH and SimGrid code. Using the <code>--help-log-categories</code> option shows the entire log category hierarchy. For instance, there is a log category that is called <code>wms</code> for the WMS, i.e., those logging messages in the <code>wrench:WMS</code> class and a log category that is called <code>simple_wms</code> for logging message in the <code>wrench::SimpleWMS</code> class, which inherits from <code><a class="el" href="classwrench_1_1_w_m_s.html" title="A workflow management system (WMS) ">wrench::WMS</a></code>. These messages are thus logging output produced by the WMS in the simple example. They can be enabled while other messages are disabled as follows:</p>
<p>``` ./wrench-simple-example-cloud platform_files/cloud_hosts.xml workflow_files/genome.dax &ndash;log=root.threshold:critical &ndash;log=simple_wms.threshold=debug &ndash;log=wms.threshold=debug ```</p>
<p>Use the <code>--help-logs</code> option displays information on the way SimGrid logging works. See the <a href="http://simgrid.gforge.inria.fr/simgrid/latest/doc/outcomes_logs.html">full SimGrid logging documentation</a> for all details.</p>
<h1><a class="anchor" id="wrench-101-simulation-output"></a>
Analyzing Simulation Output</h1>
<p>Once the <code><a class="el" href="classwrench_1_1_simulation.html#ae9589632de9a2311ed1d7f7747478985" title="Launch the simulation. ">wrench::Simulation::launch()</a></code> method has returned, it is possible to process time-stamped traces to analyze simulation output. The <code><a class="el" href="classwrench_1_1_simulation.html#aff0338aa6831c6ac252cf0673fe68f44" title="Get the simulation output object. ">wrench::Simulation::getOutput()</a></code> method returns an instance of <code><a class="el" href="classwrench_1_1_simulation_output.html" title="A class that contains post-mortem simulation-generated data. ">wrench::SimulationOutput</a></code>. This object has a templated <code><a class="el" href="classwrench_1_1_simulation_output.html#a1d03324f34db985d0e181e42cf30cd9d" title="Retrieve a copy of a simulation output trace once the simulation has completed. ">wrench::SimulationOutput::getTrace()</a></code> method to retrieve traces for various information types. For instance, the call ``` simulation.getOutput().getTrace&lt;wrench::SimulationTimestampTaskCompletion&gt;() ``` returns a vector of time-stamped task completion events. The classes that implement time-stamped events are all classes named <code>wrench::SimulationTimestampSomething</code>, where <code>Something</code> is pretty self-explanatory (e.g., <code>TaskCompletion</code>). </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/>
<address class="footer">
    <small>
        Generated by &#160;<a href="http://www.doxygen.org/index.html">
        <img class="footer" src="doxygen.png" alt="doxygen"/>
    </a> 1.8.6
    </small>
</address>
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-18066333-6', 'auto');
    ga('send', 'pageview');
</script>
</body>
<script type="text/javascript" src="doxy-boot.js"></script>
</html>
